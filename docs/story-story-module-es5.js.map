{"version":3,"sources":["webpack:///src/app/story/story.page.html","webpack:///src/app/story/story-routing.module.ts","webpack:///src/app/story/story.module.ts","webpack:///src/app/story/story.page.scss","webpack:///src/app/story/story.page.ts"],"names":["routes","path","component","StoryPageRoutingModule","imports","forChild","exports","StoryPageModule","declarations","StoryPage","data","location","visibleSentenceIndex","hiddenSentenceIndex","sentences","text","splitKeep","event","target","currentTarget","started","showNextSentence","length","back","read","selector","template","String","prototype","splitter","ahead","self","result","getSubst","value","substChar","subst","i","matches","replaceName","RegExp","r","m","e","push","index","lastIndex","nextIndex","part","substring"],"mappings":"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","file":"story-story-module-es5.js","sourcesContent":["export default \"<ion-content (click)=\\\"showNextSentence($event)\\\">\\n  <div story (click)=\\\"showNextSentence($event)\\\">\\n    <div title>{{data.title}}</div>\\n    <div #textWrapper text-wrapper>\\n      <div hider></div>\\n      <div text>\\n        <span *ngFor=\\\"let sentence of sentences; let i = index\\\">\\n          <span *ngIf=\\\"i <= visibleSentenceIndex && i > hiddenSentenceIndex\\\">{{sentence}}</span>\\n          <br *ngIf=\\\"i <= visibleSentenceIndex && i > hiddenSentenceIndex && sentence == '\\\\n'\\\"/>\\n        </span>\\n      </div>\\n    </div>\\n    <div final *ngIf=\\\"visibleSentenceIndex == sentences.length\\\">\\n      Финальные заставки\\n    </div>\\n  </div>\\n  <div starter *ngIf=\\\"!started\\\" (click)=\\\"started = true\\\">\\n    <div (click)=\\\"showNextSentence($event)\\\">\\n      Запускай запись экрана с микрофоном\\n    </div>\\n    <ion-button (click)=\\\"started = true\\\">Поехали</ion-button>\\n  </div>\\n  <div panel *ngIf=\\\"started\\\">\\n    <div remains (click)=\\\"showNextSentence($event)\\\">\\n      Осталось предложений <div (click)=\\\"showNextSentence($event)\\\">{{sentences.length - visibleSentenceIndex}}</div>\\n    </div>\\n    <ion-button restart (click)=\\\"restart()\\\">Начать с начала</ion-button>\\n    <ion-button back (click)=\\\"location.back()\\\" color=\\\"secondary\\\">Закончить</ion-button>\\n  </div>\\n</ion-content>\\n\";","import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { StoryPage } from './story.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: StoryPage\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class StoryPageRoutingModule {}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { StoryPageRoutingModule } from './story-routing.module';\n\nimport { StoryPage } from './story.page';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    StoryPageRoutingModule\n  ],\n  declarations: [StoryPage]\n})\nexport class StoryPageModule {}\n","export default \"ion-content {\\n  --background: sdfsdfsd;\\n  --color: #282828;\\n  background-image: url(https://pitshanger-ltd.co.uk/images/colours/637-TL_Tracing.jpg);\\n  background-size: contain;\\n  background-repeat: no-repeat;\\n  background-color: gray;\\n  position: relative;\\n}\\n\\n[starter] {\\n  text-align: center;\\n}\\n\\n[starter] div {\\n  font-size: 300%;\\n  padding: 20px;\\n  margin-bottom: 30px;\\n  margin-top: 30px;\\n}\\n\\n[story] {\\n  height: 100vw;\\n  position: relative;\\n}\\n\\n[title] {\\n  padding: 30px 10px;\\n  font-size: 150%;\\n}\\n\\n[text-wrapper] {\\n  padding: 0 10px 20px;\\n  max-height: 280px;\\n  overflow: scroll;\\n  scroll-behavior: smooth;\\n  /*[hider] {\\n    position: absolute;\\n    top: 0;\\n    width: 100%;\\n    height: 20px;\\n  }*/\\n}\\n\\n[final] {\\n  position: absolute;\\n  bottom: 0;\\n  margin: 0 auto;\\n  padding: 10px;\\n  text-align: center;\\n  width: 100%;\\n}\\n\\n[panel] {\\n  margin-top: 30px;\\n  padding: 10px;\\n  text-align: center;\\n}\\n\\n[panel] [remains] div {\\n  margin: -20px;\\n  font-size: 1000%;\\n  color: #3dc2ff;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy95dXJpeWxlYmlkL3Byb2plY3RzL3N0b3J5dGVsbGVyL3NyYy9hcHAvc3Rvcnkvc3RvcnkucGFnZS5zY3NzIiwic3JjL2FwcC9zdG9yeS9zdG9yeS5wYWdlLnNjc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7RUFDRSxzQkFBQTtFQUNBLGdCQUFBO0VBQ0EscUZBQUE7RUFDQSx3QkFBQTtFQUNBLDRCQUFBO0VBQ0Esc0JBQUE7RUFDQSxrQkFBQTtBQ0NGOztBRENBO0VBT0Usa0JBQUE7QUNKRjs7QURGRTtFQUNFLGVBQUE7RUFDQSxhQUFBO0VBQ0EsbUJBQUE7RUFDQSxnQkFBQTtBQ0lKOztBREFBO0VBQ0UsYUFBQTtFQUNBLGtCQUFBO0FDR0Y7O0FEREE7RUFDRSxrQkFBQTtFQUNBLGVBQUE7QUNJRjs7QURGQTtFQUNFLG9CQUFBO0VBQ0EsaUJBQUE7RUFDQSxnQkFBQTtFQUNBLHVCQUFBO0VBRUE7Ozs7O0lBQUE7QUNTRjs7QUREQTtFQUNFLGtCQUFBO0VBQ0EsU0FBQTtFQUVBLGNBQUE7RUFDQSxhQUFBO0VBQ0Esa0JBQUE7RUFDQSxXQUFBO0FDR0Y7O0FEREE7RUFDRSxnQkFBQTtFQUNBLGFBQUE7RUFDQSxrQkFBQTtBQ0lGOztBRERJO0VBQ0UsYUFBQTtFQUNBLGdCQUFBO0VBQ0EsY0FBQTtBQ0dOIiwiZmlsZSI6InNyYy9hcHAvc3Rvcnkvc3RvcnkucGFnZS5zY3NzIiwic291cmNlc0NvbnRlbnQiOlsiaW9uLWNvbnRlbnQge1xuICAtLWJhY2tncm91bmQ6IHNkZnNkZnNkO1xuICAtLWNvbG9yOiAjMjgyODI4O1xuICBiYWNrZ3JvdW5kLWltYWdlOiB1cmwoaHR0cHM6Ly9waXRzaGFuZ2VyLWx0ZC5jby51ay9pbWFnZXMvY29sb3Vycy82MzctVExfVHJhY2luZy5qcGcpO1xuICBiYWNrZ3JvdW5kLXNpemU6IGNvbnRhaW47XG4gIGJhY2tncm91bmQtcmVwZWF0OiBuby1yZXBlYXQ7XG4gIGJhY2tncm91bmQtY29sb3I6IGdyYXk7XG4gIHBvc2l0aW9uOiByZWxhdGl2ZTtcbn1cbltzdGFydGVyXSB7XG4gIGRpdiB7XG4gICAgZm9udC1zaXplOiAzMDAlO1xuICAgIHBhZGRpbmc6IDIwcHg7XG4gICAgbWFyZ2luLWJvdHRvbTogMzBweDtcbiAgICBtYXJnaW4tdG9wOiAzMHB4O1xuICB9XG4gIHRleHQtYWxpZ246IGNlbnRlcjtcbn1cbltzdG9yeV0ge1xuICBoZWlnaHQ6IDEwMHZ3O1xuICBwb3NpdGlvbjogcmVsYXRpdmU7XG59XG5bdGl0bGVdIHtcbiAgcGFkZGluZzogMzBweCAxMHB4O1xuICBmb250LXNpemU6IDE1MCU7XG59XG5bdGV4dC13cmFwcGVyXSB7XG4gIHBhZGRpbmc6IDAgMTBweCAyMHB4O1xuICBtYXgtaGVpZ2h0OiAyODBweDtcbiAgb3ZlcmZsb3c6IHNjcm9sbDtcbiAgc2Nyb2xsLWJlaGF2aW9yOiBzbW9vdGg7XG5cbiAgLypbaGlkZXJdIHtcbiAgICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gICAgdG9wOiAwO1xuICAgIHdpZHRoOiAxMDAlO1xuICAgIGhlaWdodDogMjBweDtcbiAgfSovXG59XG5cbltmaW5hbF0ge1xuICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gIGJvdHRvbTogMDtcbiAgLy9iYWNrZ3JvdW5kLWNvbG9yOiB3aGl0ZTtcbiAgbWFyZ2luOiAwIGF1dG87XG4gIHBhZGRpbmc6IDEwcHg7XG4gIHRleHQtYWxpZ246IGNlbnRlcjtcbiAgd2lkdGg6IDEwMCU7XG59XG5bcGFuZWxdIHtcbiAgbWFyZ2luLXRvcDogMzBweDtcbiAgcGFkZGluZzogMTBweDtcbiAgdGV4dC1hbGlnbjogY2VudGVyO1xuICBbcmVtYWluc10ge1xuXG4gICAgZGl2IHtcbiAgICAgIG1hcmdpbjogLTIwcHg7XG4gICAgICBmb250LXNpemU6IDEwMDAlO1xuICAgICAgY29sb3I6ICMzZGMyZmY7XG4gICAgfVxuICB9XG59XG4iLCJpb24tY29udGVudCB7XG4gIC0tYmFja2dyb3VuZDogc2Rmc2Rmc2Q7XG4gIC0tY29sb3I6ICMyODI4Mjg7XG4gIGJhY2tncm91bmQtaW1hZ2U6IHVybChodHRwczovL3BpdHNoYW5nZXItbHRkLmNvLnVrL2ltYWdlcy9jb2xvdXJzLzYzNy1UTF9UcmFjaW5nLmpwZyk7XG4gIGJhY2tncm91bmQtc2l6ZTogY29udGFpbjtcbiAgYmFja2dyb3VuZC1yZXBlYXQ6IG5vLXJlcGVhdDtcbiAgYmFja2dyb3VuZC1jb2xvcjogZ3JheTtcbiAgcG9zaXRpb246IHJlbGF0aXZlO1xufVxuXG5bc3RhcnRlcl0ge1xuICB0ZXh0LWFsaWduOiBjZW50ZXI7XG59XG5bc3RhcnRlcl0gZGl2IHtcbiAgZm9udC1zaXplOiAzMDAlO1xuICBwYWRkaW5nOiAyMHB4O1xuICBtYXJnaW4tYm90dG9tOiAzMHB4O1xuICBtYXJnaW4tdG9wOiAzMHB4O1xufVxuXG5bc3RvcnldIHtcbiAgaGVpZ2h0OiAxMDB2dztcbiAgcG9zaXRpb246IHJlbGF0aXZlO1xufVxuXG5bdGl0bGVdIHtcbiAgcGFkZGluZzogMzBweCAxMHB4O1xuICBmb250LXNpemU6IDE1MCU7XG59XG5cblt0ZXh0LXdyYXBwZXJdIHtcbiAgcGFkZGluZzogMCAxMHB4IDIwcHg7XG4gIG1heC1oZWlnaHQ6IDI4MHB4O1xuICBvdmVyZmxvdzogc2Nyb2xsO1xuICBzY3JvbGwtYmVoYXZpb3I6IHNtb290aDtcbiAgLypbaGlkZXJdIHtcbiAgICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gICAgdG9wOiAwO1xuICAgIHdpZHRoOiAxMDAlO1xuICAgIGhlaWdodDogMjBweDtcbiAgfSovXG59XG5cbltmaW5hbF0ge1xuICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gIGJvdHRvbTogMDtcbiAgbWFyZ2luOiAwIGF1dG87XG4gIHBhZGRpbmc6IDEwcHg7XG4gIHRleHQtYWxpZ246IGNlbnRlcjtcbiAgd2lkdGg6IDEwMCU7XG59XG5cbltwYW5lbF0ge1xuICBtYXJnaW4tdG9wOiAzMHB4O1xuICBwYWRkaW5nOiAxMHB4O1xuICB0ZXh0LWFsaWduOiBjZW50ZXI7XG59XG5bcGFuZWxdIFtyZW1haW5zXSBkaXYge1xuICBtYXJnaW46IC0yMHB4O1xuICBmb250LXNpemU6IDEwMDAlO1xuICBjb2xvcjogIzNkYzJmZjtcbn0iXX0= */\";","/* tslint:disable */\nimport {Component, ElementRef, OnInit, ViewChild} from '@angular/core';\nimport {DataService} from '../services/data.service';\nimport {Location} from '@angular/common';\n\n@Component({\n  selector: 'app-story',\n  templateUrl: './story.page.html',\n  styleUrls: ['./story.page.scss'],\n})\nexport class StoryPage implements OnInit {\n  private sentences: string[];\n  private visibleSentenceIndex = 0;\n  private hiddenSentenceIndex = -1;\n  started: boolean;\n\n  @ViewChild(\"textWrapper\", { read: ElementRef }) private textWrapper: ElementRef;\n\n  constructor(public data: DataService, private location: Location) { }\n\n  ngOnInit() {\n    this.sentences = this.data.text.splitKeep(/[.?!\\n]/g, false);\n  }\n\n  showNextSentence(event) {\n    if (event.target != event.currentTarget) return;\n    this.started = true;\n    this.visibleSentenceIndex++;\n\n    if (this.sentences[this.visibleSentenceIndex] == '\\n' && this.sentences[this.visibleSentenceIndex + 1] == '\\n') {\n      this.visibleSentenceIndex += 2;\n      this.hiddenSentenceIndex = this.visibleSentenceIndex;\n      this.showNextSentence(event)\n      return\n    }\n    if (this.sentences[this.visibleSentenceIndex] == '\\n') {\n      this.showNextSentence(event)\n      return\n    }\n\n    if (this.visibleSentenceIndex > this.sentences.length) {\n      this.location.back()\n    }\n    // setTimeout(() => this.textWrapper.nativeElement.scroll(0, 999999), 100)\n  }\n\n  restart() {\n    this.visibleSentenceIndex = 0;\n    this.hiddenSentenceIndex = -1;\n  }\n}\n\nString.prototype.splitKeep = function(splitter, ahead) {\n  const self = this;\n  const result: string[] = [];\n  if (splitter !== '') {\n    const matches = [];\n    // Getting mached value and its index\n    var replaceName = splitter instanceof RegExp ? \"replace\" : \"replaceAll\";\n    var r = self[replaceName](splitter, function (m, i, e) {\n      matches.push({ value: m, index: i });\n      return getSubst(m);\n    });\n    // Finds split substrings\n    var lastIndex = 0;\n    for (var i = 0; i < matches.length; i++) {\n      var m = matches[i];\n      var nextIndex = ahead == true ? m.index : m.index + m.value.length;\n      if (nextIndex != lastIndex) {\n        var part = self.substring(lastIndex, nextIndex);\n        result.push(part);\n        lastIndex = nextIndex;\n      }\n    };\n    if (lastIndex < self.length) {\n      var part = self.substring(lastIndex, self.length);\n      result.push(part);\n    };\n    // Substitution of matched string\n    function getSubst(value) {\n      var substChar = value[0] == '0' ? '1' : '0';\n      var subst = '';\n      for (var i = 0; i < value.length; i++) {\n        subst += substChar;\n      }\n      return subst;\n    };\n  }\n  else {\n    result.push(self);\n  };\n  return result;\n};\n"]}